"""Test reaction equations."""
import numpy as np

# Test values come from pychegp code

def test_troe_falloff():
    from freckll.reactions.falloff import troe_falloff_term
    k0 = np.array([2.58288430e-12, 2.45486592e-12, 2.04360183e-12, 1.37797390e-12,
       3.90188815e-13, 1.48728911e-13, 2.81876773e-13, 7.55663882e-13,
       1.51403300e-12, 2.50502748e-12, 3.57632056e-12, 4.93623891e-12,
       6.38116678e-12])
    ki=np.array([3.92819741e+09, 3.51376545e+09, 2.38137335e+09, 1.09076510e+09,
       1.21823173e+08, 2.73684009e+07, 7.26834679e+07, 3.67200174e+08,
       1.30688200e+09, 3.67240295e+09, 8.41944528e+09, 2.03364146e+10,
       4.99015840e+10])
    
    m = np.array([3.57581239e+20, 7.58837113e+19, 1.61989364e+19, 3.28066698e+18,
       5.42973739e+17, 7.62225555e+16, 1.63528555e+16, 4.77902996e+15,
       1.37736280e+15, 3.84935743e+14, 9.48470847e+13, 1.58797461e+13,
       1.13167872e+12])

    temperature = np.array([1846.3, 1827.5, 1764.8, 1651.1, 1398.2, 1266.1, 1349.5, 1515. ,
       1676.1, 1834.9, 1986. , 2176.5, 2412. ])

    result = troe_falloff_term(k0=k0, kinf=ki, m=m, temperature=temperature, a_troe=0.35, t3=1, t1=100000000.0, t2=1e18)

    expected = np.array([-0.36310058, -0.25167942, -0.18359401, -0.14316149, -0.12235864,
       -0.09769283, -0.07667554, -0.06302549, -0.05375279, -0.047021  ,
       -0.04174271, -0.03677556, -0.03179401])


    np.testing.assert_allclose(result, 10**expected)